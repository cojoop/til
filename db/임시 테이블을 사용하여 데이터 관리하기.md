# 임시 테이블을 사용하여 데이터 관리하기

임시 테이블(`Temporary Table`)은 일시적으로 데이터를 저장하는데 사용되는 테이블로, 주로 세션 동안에만 유지됩니다.
이는 복잡한 데이터 처리나 중간 결과 저장 등 다양한 상황에서 매우 유용하게 활용됩니다.

### 사용 목적

**1. 복잡한 쿼리 성능 향상**

- 여러 단계의 복잡한 쿼리를 단순화하고 성능을 개선할 수 있습니다.

**2. 중간 결과 저장**

- 데이터 처리 중 중간 단계의 결과를 저장하고 이를 기반으로 다음 단계 처리에 활용합니다.

**3. 반복 작업 최적화**

- 동일한 데이터에 대한 반복 작업을 효율적으로 처리할 수 있습니다.

**4. 커서 사용으로 인한 부하 감소**

- 서버의 커서 사용으로 인한 부하를 줄일 수 있습니다.

### 임시 테이블 생성

```sql
CREATE TEMPORARY TABLE temp_table_name (
    column1 datatype,
    column2 datatype,
    ...
);
```

#### 주요 특징

- **세션 단위 데이터 관리:** 각 세션별로 데이터가 독립적으로 관리되며, 세션이 종료되면 테이블에 저장된 데이터도 자동으로 삭제됩니다.
- **테이블 정의 유지:** 임시 테이블의 스키마(정의)는 유지되지만, 데이터는 임시적입니다.
- **빠른 처리 속도:** 일반적으로 메모리에 데이터를 저장하기 때문에 빠른 처리가 가능합니다.
- **데이터 공유 불가:** 다른 세션 간에 데이터 공유는 불가능합니다. 각 세션이 독립적으로 데이터를 관리합니다.

### 임시 테이블 사용

임시 테이블은 일반 테이블과 동일한 방식으로 사용할 수 있습니다.

- `INSERT`, `UPDATE`, `DELETE` 등의 `DML` 문 사용 가능
- `SELECT` 문으로 데이터 조회
- 인덱스 생성 가능 (외래 키 제약조건은 불가)

#### 활용 사례

**1. 복잡한 쿼리의 중간 결과 저장**

- 복잡한 쿼리를 처리할 때, 중간 결과를 임시 테이블에 저장하여 후속 쿼리에서 재사용할 수 있습니다.

**2. 여러 단계의 데이터 처리 작업**

- 단계별로 데이터를 처리할 때, 각 단계의 결과를 임시 테이블에 저장하여 관리할 수 있습니다.

**3. 커서 사용으로 인한 부하 감소**

- 커서 대신 임시 테이블을 사용하여 대량의 데이터를 처리하는 경우 성능 부하를 줄일 수 있습니다.

## WITH 절을 활용한 대안

임시 테이블 대신 `WITH` 절을 사용하여 유사한 효과를 얻을 수 있습니다.

```sql
WITH SALES_TMP AS (
  SELECT * FROM SH.SALES
)
SELECT PROD_ID, CUST_ID
FROM SALES_TMP
WHERE TIME_ID BETWEEN '1998/01/01' AND '1998/02/01';
```

### WITH 절의 장점

- 실제 테이블 생성 없이 임시 데이터셋 사용 가능
- 쿼리 성능 향상

임시 테이블은 일시적인 데이터 관리에 효과적인 도구이며, 복잡한 데이터 처리 작업을 단순화하고 성능을 개선하는 데 도움이 됩니다.
