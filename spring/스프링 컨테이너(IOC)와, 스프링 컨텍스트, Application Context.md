# 스프링 컨테이너(IoC)와 스프링 컨텍스트, Application Context

## 스프링 컨테이너(IoC)

IoC(`Inversion of Control`)는 소프트웨어 디자인 패턴 중 하나로, 객체의 생성 및 흐름을 직접 제어하지 않고, 외부에서 이를 관리하도록 하는 방식을 의미합니다.
스프링에서는 이를 구현하기 위해 DI(`Dependency Injection`)라는 방법을 사용합니다.

- **DI(Dependency Injection):** 객체 간의 의존 관계를 컨테이너가 런타임에 동적으로 주입하는 방식입니다.
즉, 애플리케이션의 구성 요소(빈)들은 서로 직접 참조하는 대신, IoC 컨테이너를 통해 필요한 의존성을 주입받습니다.

스프링에서 사용되는 IoC 컨테이너는 두 가지 형태로 존재하며, 각각의 용도와 기능에 따라 선택됩니다.

### 스프링 컨테이너의 유형

#### 1. BeanFactory

- 스프링에서 가장 기본적인 IoC 컨테이너입니다.
- DI를 제공하는 최소한의 기능만 구현한 컨테이너로, 지연 초기화(`lazy-loading`) 방식을 사용하여, 빈이 실제로 요청될 때까지 생성을 지연합니다.
- 주로 리소스가 제한된 환경에서 사용되며, 단순한 의존성 주입이 필요한 경우에 유리합니다.

#### 2. ApplicationContext

- BeanFactory의 기능을 확장한 고급 컨테이너입니다.
- 모든 기능을 갖춘 IoC 컨테이너로, 다양한 엔터프라이즈급 기능(이벤트 발행, AOP 지원, 메시지 소스 처리 등)을 제공합니다.
- 즉시 초기화 방식(`eager-loading`)을 사용하여 애플리케이션 시작 시 빈을 모두 생성하고 초기화합니다.
- 대부분의 스프링 애플리케이션에서는 ApplicationContext를 사용합니다.

### 스프링 컨텍스트 (Spring Context)

스프링 컨텍스트는 스프링의 ApplicationContext를 기반으로 하는 IoC 컨테이너의 개념입니다.

#### 주요 특징

- **빈 라이프사이클 관리:** 빈의 생성, 초기화, 사용, 소멸 등의 생명주기를 관리합니다. 이 생명주기 동안 스프링은 자동으로 빈을 관리하고 필요한 경우 의존성을 주입합니다.
- **이벤트 처리:** 스프링 컨텍스트는 빈 간의 이벤트를 발행하고 처리할 수 있는 이벤트 시스템을 제공합니다.
- **AOP 지원:** 애스펙트 지향 프로그래밍을 통해 로깅, 트랜잭션 관리, 보안 등의 공통 관심사를 쉽게 분리할 수 있습니다.
- **국제화(i18n):** 다국어 지원을 위해 메시지 소스를 관리하고, 다국어 변환 기능을 제공합니다.

### ApplicationContext

ApplicationContext는 스프링 프레임워크에서 가장 많이 사용되는 IoC 컨테이너입니다.
BeanFactory의 모든 기능을 포함하면서도, 엔터프라이즈 애플리케이션에서 필요한 다양한 추가 기능을 제공합니다.

#### 추가 기능 및 특징

- **메시지 소스 처리:** 국제화를 위한 메시지 관리가 가능합니다.
- **이벤트 시스템:** 컨텍스트 내부에서 발생하는 이벤트를 감지하고 핸들링할 수 있습니다.
- **환경 추상화:** 다양한 외부 환경에 따라 프로파일 및 설정을 분리하고 관리할 수 있는 기능을 제공합니다.
- **자원 로딩(ResourceLoader):** 외부 파일이나 리소스를 읽어오는 기능을 포함하고 있습니다.

#### ApplicationContext의 주요 구현체

##### 1. AnnotationConfigApplicationContext

- 자바 설정 클래스(`@Configuration`)를 통해 빈을 설정하고 관리하는 방식입니다. XML 파일 대신 자바 기반 설정을 선호하는 현대적인 방식입니다.

##### 2. ClassPathXmlApplicationContext

- 클래스패스에 있는 XML 파일을 읽어 스프링 빈 설정을 하는 방식입니다. 스프링 초기 버전에서 많이 사용된 방식입니다.

##### 3. FileSystemXmlApplicationContext

- 파일 시스템 경로에서 XML 파일을 읽어와 빈을 설정하는 방식입니다. 주로 외부에서 관리되는 설정 파일을 사용할 때 유용합니다.

### 빈(Bean)의 생명주기

1. 빈 정의: 스프링 컨테이너는 XML 파일이나 자바 설정 클래스를 통해 빈의 정의를 읽어들입니다.
2. 빈 생성: 컨테이너는 빈을 생성합니다. 빈은 기본적으로 싱글톤 패턴으로 생성됩니다.
3. 의존성 주입: 생성된 빈에 필요한 의존성 객체를 주입합니다.
4. 초기화(`Initialization`): 빈 생성 후 `@PostConstruct`나 `InitializingBean` 인터페이스를 통해 초기화 작업을 수행합니다.
5. 사용(`Usage`): 빈이 사용됩니다.
6. 소멸(`Destruction`): 애플리케이션 종료 시, `@PreDestroy` 또는 DisposableBean을 사용하여 자원을 정리하고 소멸됩니다.

### 스프링 컨텍스트의 계층 구조

스프링 애플리케이션에서는 계층 구조로 컨텍스트를 관리할 수 있습니다.
일반적으로 애플리케이션의 전반적인 설정을 담당하는 Root Application Context와, 웹 애플리케이션의 각 서블릿별로 별도의 Servlet Application Context를 사용하여 계층적으로 구성합니다.

#### 예시

- **Root Application Context:** 데이터베이스 연결, 공통 서비스 빈과 같은 전체 애플리케이션에서 사용되는 빈들을 정의.
- **Servlet Application Context:** 각 서블릿이 필요로 하는 컨트롤러, 뷰 리졸버 등 웹 관련 빈들을 정의.
